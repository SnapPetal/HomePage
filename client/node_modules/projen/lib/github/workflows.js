"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.GithubWorkflow = void 0;
const YAML = require("yaml");
const file_1 = require("../file");
/**
 * @experimental
 */
class GithubWorkflow extends file_1.FileBase {
    /**
     * @experimental
     */
    constructor(github, name) {
        super(github.project, `.github/workflows/${name.toLocaleLowerCase()}.yml`);
        this.events = {};
        this.jobs = {};
        this.name = name;
    }
    /**
     * @experimental
     */
    on(events) {
        this.events = {
            ...this.events,
            ...events,
        };
    }
    /**
     * @experimental
     */
    addJobs(jobs) {
        this.jobs = {
            ...this.jobs,
            ...jobs,
        };
    }
    /**
     * (experimental) Implemented by derived classes and returns the contents of the file to emit.
     *
     * @experimental
     */
    synthesizeContent(resolver) {
        const workflow = resolver.resolve({
            name: this.name,
            on: this.events,
            jobs: this.jobs,
        });
        return [
            `# ${file_1.FileBase.PROJEN_MARKER}`,
            YAML.stringify(workflow),
        ].join('\n');
    }
}
exports.GithubWorkflow = GithubWorkflow;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid29ya2Zsb3dzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2dpdGh1Yi93b3JrZmxvd3MudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsNkJBQTZCO0FBQzdCLGtDQUE4Qzs7OztBQUc5QyxNQUFhLGNBQWUsU0FBUSxlQUFROzs7O0lBSzFDLFlBQVksTUFBYyxFQUFFLElBQVk7UUFDdEMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQUUscUJBQXFCLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxNQUFNLENBQUMsQ0FBQztRQUpyRSxXQUFNLEdBQTZCLEVBQUcsQ0FBQztRQUN2QyxTQUFJLEdBQTZCLEVBQUcsQ0FBQztRQUkzQyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztJQUNuQixDQUFDOzs7O0lBRU0sRUFBRSxDQUFDLE1BQWdDO1FBQ3hDLElBQUksQ0FBQyxNQUFNLEdBQUc7WUFDWixHQUFHLElBQUksQ0FBQyxNQUFNO1lBQ2QsR0FBRyxNQUFNO1NBQ1YsQ0FBQztJQUNKLENBQUM7Ozs7SUFFTSxPQUFPLENBQUMsSUFBOEI7UUFDM0MsSUFBSSxDQUFDLElBQUksR0FBRztZQUNWLEdBQUcsSUFBSSxDQUFDLElBQUk7WUFDWixHQUFHLElBQUk7U0FDUixDQUFDO0lBQ0osQ0FBQzs7Ozs7O0lBRVMsaUJBQWlCLENBQUMsUUFBbUI7UUFDN0MsTUFBTSxRQUFRLEdBQUcsUUFBUSxDQUFDLE9BQU8sQ0FBQztZQUNoQyxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUk7WUFDZixFQUFFLEVBQUUsSUFBSSxDQUFDLE1BQU07WUFDZixJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUk7U0FDaEIsQ0FBQyxDQUFDO1FBRUgsT0FBTztZQUNMLEtBQUssZUFBUSxDQUFDLGFBQWEsRUFBRTtZQUM3QixJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQztTQUN6QixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNmLENBQUM7Q0FDRjtBQXBDRCx3Q0FvQ0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBZQU1MIGZyb20gJ3lhbWwnO1xuaW1wb3J0IHsgRmlsZUJhc2UsIElSZXNvbHZlciB9IGZyb20gJy4uL2ZpbGUnO1xuaW1wb3J0IHsgR2l0SHViIH0gZnJvbSAnLi9naXRodWInO1xuXG5leHBvcnQgY2xhc3MgR2l0aHViV29ya2Zsb3cgZXh0ZW5kcyBGaWxlQmFzZSB7XG4gIHByaXZhdGUgcmVhZG9ubHkgbmFtZTogc3RyaW5nO1xuICBwcml2YXRlIGV2ZW50czogeyBbZXZlbnQ6IHN0cmluZ106IGFueSB9ID0geyB9O1xuICBwcml2YXRlIGpvYnM6IHsgW2pvYmlkOiBzdHJpbmddOiBhbnkgfSA9IHsgfTtcblxuICBjb25zdHJ1Y3RvcihnaXRodWI6IEdpdEh1YiwgbmFtZTogc3RyaW5nKSB7XG4gICAgc3VwZXIoZ2l0aHViLnByb2plY3QsIGAuZ2l0aHViL3dvcmtmbG93cy8ke25hbWUudG9Mb2NhbGVMb3dlckNhc2UoKX0ueW1sYCk7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgfVxuXG4gIHB1YmxpYyBvbihldmVudHM6IHsgW2V2ZW50OiBzdHJpbmddOiBhbnkgfSkge1xuICAgIHRoaXMuZXZlbnRzID0ge1xuICAgICAgLi4udGhpcy5ldmVudHMsXG4gICAgICAuLi5ldmVudHMsXG4gICAgfTtcbiAgfVxuXG4gIHB1YmxpYyBhZGRKb2JzKGpvYnM6IHsgW2pvYmlkOiBzdHJpbmddOiBhbnkgfSkge1xuICAgIHRoaXMuam9icyA9IHtcbiAgICAgIC4uLnRoaXMuam9icyxcbiAgICAgIC4uLmpvYnMsXG4gICAgfTtcbiAgfVxuXG4gIHByb3RlY3RlZCBzeW50aGVzaXplQ29udGVudChyZXNvbHZlcjogSVJlc29sdmVyKSB7XG4gICAgY29uc3Qgd29ya2Zsb3cgPSByZXNvbHZlci5yZXNvbHZlKHtcbiAgICAgIG5hbWU6IHRoaXMubmFtZSxcbiAgICAgIG9uOiB0aGlzLmV2ZW50cyxcbiAgICAgIGpvYnM6IHRoaXMuam9icyxcbiAgICB9KTtcblxuICAgIHJldHVybiBbXG4gICAgICBgIyAke0ZpbGVCYXNlLlBST0pFTl9NQVJLRVJ9YCxcbiAgICAgIFlBTUwuc3RyaW5naWZ5KHdvcmtmbG93KSxcbiAgICBdLmpvaW4oJ1xcbicpO1xuICB9XG59XG4iXX0=